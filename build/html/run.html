
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Compiling and running the model &#8212; E3SM Atmosphere Model (EAM)  documentation</title>
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="List of output variables" href="output.html" />
    <link rel="prev" title="Getting Started" href="start.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="output.html" title="List of output variables"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="start.html" title="Getting Started"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">E3SM Atmosphere Model (EAM)  documentation</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Compiling and running the model</a><ul>
<li><a class="reference internal" href="#run-script">Run Script</a></li>
<li><a class="reference internal" href="#creating-a-new-case">Creating a new case</a></li>
<li><a class="reference internal" href="#setting-compsets">Setting compsets</a></li>
<li><a class="reference internal" href="#changing-spatial-resolutions">Changing Spatial Resolutions</a></li>
<li><a class="reference internal" href="#debugging-mode">Debugging mode</a></li>
<li><a class="reference internal" href="#sanity-check-for-state-variables">Sanity-check for state variables</a></li>
<li><a class="reference internal" href="#switching-on-cosp-simulator">Switching on COSP Simulator</a></li>
<li><a class="reference internal" href="#switching-on-nudging">Switching on Nudging</a></li>
<li><a class="reference internal" href="#switching-on-aerosol-forcing-diagnostics">Switching on Aerosol Forcing Diagnostics</a></li>
<li><a class="reference internal" href="#changing-external-forcings">Changing External Forcings</a></li>
<li><a class="reference internal" href="#single-column-model-scm-simulations">Single column model (SCM) simulations</a></li>
<li><a class="reference internal" href="#frequently-used-namelist-options">Frequently-used namelist options</a></li>
<li><a class="reference internal" href="#other-options">Other options</a></li>
<li><a class="reference internal" href="#reference">Reference</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="start.html"
                        title="previous chapter">Getting Started</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="output.html"
                        title="next chapter">List of output variables</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/run.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <p id="run"><a class="reference external" href="https://github.com/kaizhangpnl/kaizhangpnl.github.io/blob/master/source/run.rst">Github version</a></p>
<p><a class="reference external" href="https://kaizhangpnl.github.io/EAM_User_Guide/run.html">Spinx version</a></p>
<div class="section" id="compiling-and-running-the-model">
<h1>Compiling and running the model<a class="headerlink" href="#compiling-and-running-the-model" title="Permalink to this headline">¶</a></h1>
<p>First of all, please read</p>
<p><a class="reference external" href="https://e3sm.org/model/running-e3sm/e3sm-quick-start/">E3SM Quick Start</a></p>
<div class="section" id="run-script">
<h2>Run Script<a class="headerlink" href="#run-script" title="Permalink to this headline">¶</a></h2>
<p>A <a class="reference external" href="https://github.com/E3SM-Project/E3SM/blob/master/run_e3sm.template.csh">runscript</a>
is available in the E3SM model source code directory (parallel to “cime” and “compoment”).</p>
</div>
<div class="section" id="creating-a-new-case">
<h2>Creating a new case<a class="headerlink" href="#creating-a-new-case" title="Permalink to this headline">¶</a></h2>
<p>A new case is often created for each simulation</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>./create_newcase -case $temp_case_scripts_dir  \
                 -mach $newcase_machine        \
                 -compset $compset             \
                 -res $resolution              \
                 -project $project             \
                 -pecount $std_proc_configuration
</pre></div>
</div>
</div>
<div class="section" id="setting-compsets">
<h2>Setting compsets<a class="headerlink" href="#setting-compsets" title="Permalink to this headline">¶</a></h2>
<p>Available compsets for E3SM can be found in:</p>
<blockquote>
<div><a class="reference external" href="https://github.com/E3SM-Project/E3SM/blob/master/cime/config/e3sm/allactive/config_compsets.xml">cime/config/e3sm/allactive/config_compsets.xml</a></div></blockquote>
<p>Available compsets for EAM can be found in:</p>
<blockquote>
<div><a class="reference external" href="https://github.com/E3SM-Project/E3SM/blob/master/components/cam/cime_config/config_compsets.xml">components/cam/cime_config/config_compsets.xml</a></div></blockquote>
<p>The most frequently used compsets are listed below:</p>
<ul>
<li><p class="first"><strong>FC5AV1C-04P2</strong>  <a class="reference external" href="https://github.com/E3SM-Project/E3SM/blob/master/components/cam/bld/namelist_files/use_cases/2000_cam5_av1c-04p2.xml">namelist setup</a></p>
<p>V1 atmosphere-only simulation with present-day external forcing. Tuning settings are for the ne30L72 resolution.</p>
<p>The present-day external forcing (so-called “year 2000”, mean of 1995-2005) will be used.
The anthropogenic aerosol emissions and greenhouse gas concentration are constant.
The atmosphere model is coupled with the ELM land model (similar to CLM4.5), and
driven by prescribed climatological SST / sea ice cover.</p>
</li>
<li><p class="first"><strong>F1850C5AV1C-04P2</strong>  <a class="reference external" href="https://github.com/E3SM-Project/E3SM/blob/master/components/cam/bld/namelist_files/use_cases/1850_cam5_av1c-04p2.xml">namelist setup</a></p>
<p>V1 atmosphere-only simulation with pre-industrial external forcing. Tuning settings are for the ne30L72 resolution.</p>
</li>
<li><p class="first"><strong>FC5</strong>  <a class="reference external" href="https://github.com/E3SM-Project/E3SM/blob/master/components/cam/bld/namelist_files/use_cases/2000_cam5_cosp.xml">namelist setup</a></p>
<p>V0-like atmosphere-only simulation with present-day external forcing. Tuning settings are for the ne30L30 resolution.
Note that some tuning parameters need to be changed for version 0.3.</p>
</li>
<li><p class="first"><strong>F1850C5</strong>  <a class="reference external" href="https://github.com/E3SM-Project/E3SM/blob/master/components/cam/bld/namelist_files/use_cases/1850_cam5.xml">namelist setup</a></p>
<p>V0-like atmosphere-only simulation with pre-industrial external forcing. Tuning settings are for the ne30L30 resolution.
Note that some tuning parameters need to be changed for version 0.3.</p>
</li>
<li><p class="first"><strong>FC5AV1C-H01C</strong> <a class="reference external" href="https://github.com/E3SM-Project/E3SM/blob/master/components/cam/bld/namelist_files/use_cases/2000_cam5_av1c-h01c.xml">namelist setup</a></p>
<p>High-resolution (ne120L72) V1 atmosphere-only simulation with present-day external forcing.</p>
</li>
<li><p class="first"><strong>F1850C5AV1C-H01C</strong> <a class="reference external" href="https://github.com/E3SM-Project/E3SM/blob/master/components/cam/bld/namelist_files/use_cases/2000_cam5_av1c-h01c.xml">namelist setup</a></p>
<p>High-resolution (ne120L72) V1 atmosphere-only simulation with  pre-industrial external forcing.</p>
</li>
<li><p class="first"><strong>F20TRC5-CMIP6</strong> <a class="reference external" href="https://github.com/E3SM-Project/E3SM/blob/master/components/cam/bld/namelist_files/use_cases/20TR_cam5_CMIP6.xml">namelist setup</a></p>
<p>V1 atmosphere-only simulation with time-varying 20th-century external forcing from CMIP6.</p>
</li>
</ul>
</div>
<div class="section" id="changing-spatial-resolutions">
<h2>Changing Spatial Resolutions<a class="headerlink" href="#changing-spatial-resolutions" title="Permalink to this headline">¶</a></h2>
<p>Technically, EAM can run with horizontal resolution from ne4 (about 750km) to ne120 (about 25km)
(with F1850C5AV1C-04P2 compset). To change the horizontal resolution, set</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span> <span class="n">resolution</span> <span class="o">=</span> <span class="n">ne30_ne30</span> <span class="p">(</span><span class="ow">or</span> <span class="n">ne4_ne4</span><span class="p">,</span> <span class="n">ne11_ne11</span><span class="p">,</span> <span class="n">ne16_ne16</span><span class="p">,</span> <span class="n">ne120_ne120</span><span class="p">)</span>
</pre></div>
</div>
<p>before executing “create_newcase”</p>
<p>The vertical resolution is L30 for V0 and L72 for V1.</p>
</div>
<div class="section" id="debugging-mode">
<h2>Debugging mode<a class="headerlink" href="#debugging-mode" title="Permalink to this headline">¶</a></h2>
<p>Before compiling the code</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">xmlchange</span> <span class="o">-</span><span class="n">file</span> <span class="n">env_build</span><span class="o">.</span><span class="n">xml</span> <span class="o">-</span><span class="nb">id</span> <span class="n">DEBUG</span> <span class="o">-</span><span class="n">val</span> <span class="s2">&quot;TRUE&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="sanity-check-for-state-variables">
<h2>Sanity-check for state variables<a class="headerlink" href="#sanity-check-for-state-variables" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p class="first">Namelist change</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cat</span> <span class="o">&lt;&lt;</span><span class="n">EOF</span> <span class="o">&gt;&gt;</span> <span class="n">user_nl_cam</span>
  <span class="n">state_debug_checks</span> <span class="o">=</span> <span class="o">.</span><span class="n">true</span><span class="o">.</span>
<span class="n">EOF</span>
</pre></div>
</div>
</li>
</ul>
<p>The model will check if the state variables are within a plausible range
(e.g. temperature above zero) when physics_upstate is called.
Note that this sanity-check will be switched on automatically when the model is
running in debugging mode.</p>
</div>
<div class="section" id="switching-on-cosp-simulator">
<h2>Switching on COSP Simulator<a class="headerlink" href="#switching-on-cosp-simulator" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p class="first">Configuration</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">xmlchange</span> <span class="o">-</span><span class="n">append</span> <span class="o">-</span><span class="n">file</span> <span class="n">env_build</span><span class="o">.</span><span class="n">xml</span> <span class="o">-</span><span class="nb">id</span> <span class="n">CAM_CONFIG_OPTS</span> <span class="o">-</span><span class="n">val</span> <span class="s2">&quot;-cosp&quot;</span>
</pre></div>
</div>
</li>
<li><p class="first">Namelist change</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>cat &lt;&lt;EOF &gt;&gt; user_nl_cam
  docosp = .true. !!! needed for some versions of E3SM
  cosp_lite = .true.
EOF
</pre></div>
</div>
</li>
</ul>
<p>If cosp_lite = true, the COSP cloud simulators are run to produce
select output for the AMWG diagnostics package.
sets cosp_ncolumns=10 and cosp_nradsteps=3
(appropriate for COSP statistics derived from seasonal averages),
and runs MISR, ISCCP, MODIS, and CALIPSO lidar simulators
(cosp_lmisr_sim=.true.,cosp_lisccp_sim=.true.,
cosp_lmodis_sim=.true.,cosp_llidar_sim=.true.).
This default logical is set in cospsimulator_intr.F90.</p>
</div>
<div class="section" id="switching-on-nudging">
<h2>Switching on Nudging<a class="headerlink" href="#switching-on-nudging" title="Permalink to this headline">¶</a></h2>
<p>An introduction of nudging can be found in
<a class="reference external" href="https://www.atmos-chem-phys.net/14/8631/2014/">Zhang et al. (2014)</a> and references therein.</p>
<p>The following variables need to be modified to activate nudging.
The example shown below allows nudging for horizontal winds</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>cat &lt;&lt;EOF &gt;&gt; user_nl_cam
 !.......................................................
 ! nudging
 !.......................................................
  Nudge_Model = .True.
  Nudge_Path  = &#39;${INPUT_NUDGING}/ne30/&#39;
  Nudge_File_Template = &#39;ACME.cam.h2.%y-%m-%d-00000.nc&#39;
  Nudge_Times_Per_Day = 4  !! nudging input data frequency
  Model_Times_Per_Day = 48 !! should not be larger than 48 if dtime = 1800s
  Nudge_Uprof = 1
  Nudge_Ucoef = 1.
  Nudge_Vprof = 1
  Nudge_Vcoef = 1.
  Nudge_Tprof = 0
  Nudge_Tcoef = 0.
  Nudge_Qprof = 0
  Nudge_Qcoef = 0.
  Nudge_PSprof = 0
  Nudge_PScoef = 0.
  Nudge_Beg_Year = 0000
  Nudge_Beg_Month = 1
  Nudge_Beg_Day = 1
  Nudge_End_Year = 9999
  Nudge_End_Month = 1
  Nudge_End_Day = 1
 EOF
</pre></div>
</div>
<p>This setup will nudge the model towards a baseline simulation. The nudging data were
created from the baseline simulation by archiving the 6-hourly meteorological fields.
Only the horizontal winds are nudged, with a relaxation time scale of 6h.</p>
</div>
<div class="section" id="switching-on-aerosol-forcing-diagnostics">
<h2>Switching on Aerosol Forcing Diagnostics<a class="headerlink" href="#switching-on-aerosol-forcing-diagnostics" title="Permalink to this headline">¶</a></h2>
<p>Namelist setup</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cat</span> <span class="o">&lt;&lt;</span><span class="n">EOF</span> <span class="o">&gt;&gt;</span> <span class="n">user_nl_cam</span>
   <span class="n">rad_diag_1</span> <span class="o">=</span> <span class="s1">&#39;A:Q:H2O&#39;</span><span class="p">,</span> <span class="s1">&#39;N:O2:O2&#39;</span><span class="p">,</span> <span class="s1">&#39;N:CO2:CO2&#39;</span><span class="p">,</span> <span class="s1">&#39;A:O3:O3&#39;</span><span class="p">,</span> <span class="s1">&#39;N:N2O:N2O&#39;</span><span class="p">,</span> <span class="s1">&#39;N:CH4:CH4&#39;</span><span class="p">,</span> <span class="s1">&#39;N:CFC11:CFC11&#39;</span><span class="p">,</span> <span class="s1">&#39;N:CFC12:CFC12&#39;</span><span class="p">,</span>
<span class="n">EOF</span>
</pre></div>
</div>
<p>Then the radiative flux calculated without aerosols are diagnosed
(with “_d1” appended to the original radiative flux name, e.g. “FSNT_d1”).</p>
<p>The detailed diagnostic method can be found in <a class="reference external" href="https://www.atmos-chem-phys.net/13/9971/2013/">Ghan (2013)</a>.</p>
</div>
<div class="section" id="changing-external-forcings">
<h2>Changing External Forcings<a class="headerlink" href="#changing-external-forcings" title="Permalink to this headline">¶</a></h2>
<p>The following changes need to be made after executing “create_newcase”.</p>
<ul>
<li><p class="first">Changing SST, e.g.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">xmlchange</span> <span class="o">-</span><span class="n">file</span> <span class="n">env_run</span><span class="o">.</span><span class="n">xml</span> <span class="o">-</span><span class="nb">id</span> <span class="n">SSTICE_DATA_FILENAME</span> <span class="o">-</span><span class="n">val</span> <span class="s1">&#39;$DIN_LOC_ROOT/atm/cam/sst/sst_HadOIBl_bc_1x1_clim_pi_c101029.nc&#39;</span>
<span class="o">./</span><span class="n">xmlchange</span> <span class="o">-</span><span class="n">file</span> <span class="n">env_run</span><span class="o">.</span><span class="n">xml</span> <span class="o">-</span><span class="nb">id</span> <span class="n">SSTICE_DATA_FILENAME</span> <span class="o">-</span><span class="n">val</span> <span class="s1">&#39;$DIN_LOC_ROOT/atm/cam/sst/sst_HadOIBl_bc_1x1_clim_pi_plus4K.nc&#39;</span>
</pre></div>
</div>
</li>
<li><p class="first">Changing aerosol emissions, e.g.</p>
</li>
</ul>
</div>
<div class="section" id="single-column-model-scm-simulations">
<h2>Single column model (SCM) simulations<a class="headerlink" href="#single-column-model-scm-simulations" title="Permalink to this headline">¶</a></h2>
<p>EAM can run in the single column mode.
Some instructions on how to configure and run a single column model can be found
<a class="reference external" href="https://acme-climate.atlassian.net/wiki/spaces/Docs/pages/128294958/Running+the+ACME+Single+Column+Model">here</a>.</p>
<p>A runscript template can be found <a class="reference external" href="https://github.com/kaizhangpnl/kaizhangpnl.github.io/blob/master/source/scm_runscript.rst">here</a>.</p>
<p>IOP forcing data to drive the SCM can be found
<a class="reference external" href="https://acme-climate.atlassian.net/wiki/spaces/Docs/pages/127456636/ACME+Single-Column+Model+Case+Library">here</a>.</p>
</div>
<div class="section" id="frequently-used-namelist-options">
<h2>Frequently-used namelist options<a class="headerlink" href="#frequently-used-namelist-options" title="Permalink to this headline">¶</a></h2>
<p>The following namelist options are frequently used for detailed diagnostics:</p>
<ul>
<li><p class="first">Switch for diagnostic output of the aerosol tendencies</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">history_aerosol</span> <span class="o">=</span> <span class="o">.</span><span class="n">true</span><span class="o">.</span>
</pre></div>
</div>
</li>
<li><p class="first">Switch for diagnostic output of the aerosol optics</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">history_aero_optics</span> <span class="o">=</span> <span class="o">.</span><span class="n">true</span><span class="o">.</span>
</pre></div>
</div>
</li>
<li><p class="first">Produce output for the AMWG diagnostic package</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">history_amwg</span> <span class="o">=</span> <span class="o">.</span><span class="n">true</span><span class="o">.</span>
</pre></div>
</div>
</li>
<li><p class="first">Switch for water/heat budget analysis output</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">history_budget</span> <span class="o">=</span> <span class="o">.</span><span class="n">true</span><span class="o">.</span>
</pre></div>
</div>
</li>
<li><p class="first">Switch for the AMWG variability diagnostics output</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">history_vdiag</span> <span class="o">=</span> <span class="o">.</span><span class="n">true</span><span class="o">.</span>
</pre></div>
</div>
</li>
<li><p class="first">Switch for verbose (mostly aerosol-related) history output</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">history_verbose</span> <span class="o">=</span> <span class="o">.</span><span class="n">true</span><span class="o">.</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="other-options">
<h2>Other options<a class="headerlink" href="#other-options" title="Permalink to this headline">¶</a></h2>
<p>The complete namelist options are listed in:</p>
<blockquote>
<div><a class="reference external" href="https://github.com/E3SM-Project/E3SM/blob/master/components/cam/bld/namelist_files/namelist_definition.xml">components/cam/bld/namelist_files/namelist_definition.xml</a></div></blockquote>
</div>
<div class="section" id="reference">
<h2>Reference<a class="headerlink" href="#reference" title="Permalink to this headline">¶</a></h2>
<p>Documentation from <a class="reference external" href="http://www.cesm.ucar.edu/models/cesm1.2/cam/docs/ug5_3/">CAM5.3</a>.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="output.html" title="List of output variables"
             >next</a> |</li>
        <li class="right" >
          <a href="start.html" title="Getting Started"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">E3SM Atmosphere Model (EAM)  documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, E3SM.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.2.
    </div>
  </body>
</html>